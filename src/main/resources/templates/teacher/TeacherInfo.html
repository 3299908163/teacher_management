<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用户信息</title>
    <script src="/js/const/jquery-3.3.1.js"></script>
    <script src="/layui/layui.all.js"></script>
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">
</head>

<form class="layui-form" >
    <div class="layui-form-item">

        <input type="button" class="layui-btn" value="搜索" onclick="loadData();"/>

        <button type="button" class="layui-btn" id="test3"><i class="layui-icon"></i>选择文件添加多个学员（仅支持xlsx/xls文件）</button>

        <div class="layui-input-inline">
            <input type="text" name="title" required  lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input userName" style="width: 200px">
        </div>
        <label class="layui-form-label">选择学科</label>
        <div class="layui-input-inline">
            <select id="subjectInfo"  lay-filter="subjectId" >
                <option value="0" selected="selected">请选择</option>
                <#list subjectList as subject>
                <option value="${subject.subjectId}">${subject.subjectName}</option>
            </#list>
            </select>
        </div>
        <label class="layui-form-label">选择身份</label>
        <div class="layui-input-inline">
            <select id="isAdmin1"  lay-filter="isAdmin1" >
                <option value="-1" selected="selected">请选择</option>
                <option value="0">普通员工</option>
                <option value="1">管理员</option>
            </select>
        </div>
        <br>
        <label class="layui-form-label">职称资格种类</label>
        <div class="layui-input-inline">
            <select id="titleInfo"  lay-filter="titleId" >
                <option value="0" selected="selected">请选择</option>
                <#list titleList as title>
                <option value="${title.titleId}">${title.titleName}</option>
            </#list>
            </select>
        </div>
        <label class="layui-form-label">选择教师资格种类</label>
        <div class="layui-input-inline">
            <select id="qualificationInfo"  lay-filter="qualificationId" >
                <option value="0" selected="selected">请选择</option>
                <#list qualificationList as qualification>
                <option value="${qualification.qualificationId}">${qualification.qualificationName}</option>
            </#list>
            </select>
        </div>
        <label class="layui-form-label">选择学位</label>
        <div class="layui-input-inline">
            <select id="degreeInfo"  lay-filter="degreeId" >
                <option value="0" selected="selected">请选择</option>
                <#list degreeList as degree>
                <option value="${degree.degreeId}">${degree.degreeName}</option>
            </#list>
            </select>
        </div>
    </div>
</form>
<table id="demo" lay-filter="test">

</table>
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container" id="layerDemo">
        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">修改信息</button>
        <button class="layui-btn layui-btn-sm" data-type="getCheckLength" lay-event="getCheckLength">删除信息（点击复选框进行删除）</button>
    </div>
</script>
<script>
    // layui.use(['form'], function () {
    //     var form = layui.form;
    //     form.on('select(isAdmin)', function(data){
    //         if(data.value>-1){
    //             isAdmin=data.value;
    //             loadData();
    //         }  if(data.value==-1) {
    //             isAdmin=null;
    //             loadData();
    //         }
    //     });
    // });
    layui.use('upload', function(){
        var $ = layui.jquery,upload = layui.upload;
        upload.render({
            elem: '#test3'
            ,url: '/sys/import'
            ,method: 'post'
            ,exts:'xls|xlsx'
            ,accept: 'file' //普通文件
            ,done: function(res){
                layer.msg("添加成功！");
                loadData();
            }
            ,error: function(res){
                alert(res)
            }
        })
    })

    $(function () {
        loadData();
    })
    function loadData(){
        var userName=$(".userName").val();
        var subjectId=$("#subjectInfo").val();
        var titleId=$("#titleInfo").val();
        var qualificationId=$("#qualificationInfo").val();
        var degreeId=$("#degreeInfo").val();
        var isAdmin1=$("#isAdmin1").val();
        layui.use('table',function(){
            var table = layui.table;
            //第一个实例
            table.render({
                elem: '#demo'
                ,height: 'full'
                ,url: '/teacher/teacherList?subjectId='+subjectId+"&titleId="+titleId+"&qualificationId="+qualificationId+"&degreeId="+degreeId+"&userName="+userName+"&isAdmin="+isAdmin1 //数据接口
                //    ,edit: 'text'
                ,page: {     //支持传入layuipage组件的所有参数
                    layout: ['count', 'prev', 'page', 'next', 'limit', 'refresh', 'skip']//自定义分页布局
                    , limits: [5, 10, 15]
                    , first: false //不显示首页
                    , last: false //不显示尾页
                }
                ,toolbar:"#toolbarDemo"
                ,cols: [[ //表头
                    {type:'checkbox',fixed: 'left'}
                    ,{field: 'userId', title: '教师编号',hide:true}
                    ,{field: 'userName', title: '教师名'}
                    ,{field: 'userIdentity', title: '身份证',  sort: true}
                    ,{field: 'userAddress', title: '地址'}
                    ,{field: 'userPhone', title: '电话'}
                    // d.subject.subjectName的获取原理是，在分页Controller中封装了Teacher的data，在前端取会默认将data缩写为d
                    ,{field: 'subjectName', title: '任教学科',  templet: '<div>{{d.subject.subjectName}}</div>'}
                    ,{field: 'userSex', title: '性别'}
                    ,{field: 'titleName', title:'职称资格',templet: '<div>{{d.title.titleName}}</div>'}
                    ,{field: 'titleTime', title:'职称资格时间'}
                    ,{field: 'qualificationName', title:'教师资格种类',templet: '<div>{{d.qualification.qualificationName}}</div>'}
                    ,{field: 'positionName',title:'专业技术职务',hide:true}
                    ,{field: 'degreeName', title:'学位',templet: '<div>{{d.degree.degreeName}}</div>'}
                    ,{field: 'userJoinparty', title: '入党时间'}
                    ,{field: 'userWorkhours', title: '参与工作时间'}
                    ,{field: 'userBirthday', title:'教师生日'}
                    ,{field: 'userEmail', title: '邮箱'}
                    ,{field: 'contractName', title: '合同名字', templet: '<div>{{d.contract.contractName}}</div>',hide:true}
                    ,{field: 'contractStarttime', title:'首聘时间',hide:true}
                    ,{field: 'contractEndtime', title: '聘任时间',hide:true}
                    ,{field: 'educationFirstName', title: '第一学历',hide:true}
                    ,{field: 'educationFirstSchool', title: '第一学历毕业院校',hide:true}
                    ,{field: 'educationFirstProfessionalName', title:'第一学历所学专业',hide:true}
                    ,{field: 'educationFirstGraduationtime', title:'第一学历毕业时间',hide:true}
                    ,{field: 'educationHighestName', title: '最高学历',hide:true}
                    ,{field: 'educationHighestSchool', title: '最高学历毕业院校',hide:true}
                    ,{field: 'educationHighestProfessionalName', title:'最高学历所学专业',hide:true}
                    ,{field: 'educationHighestGraduationtime', title:'最高学历毕业时间',hide:true}
                    ,{field: 'remake', title: '备注'}
                    ,{field: 'isAdmin', title: '身份', sort: true}
                ]]
                /*,where: {
                    // //.渲染请求参数(查询条件等)
                    gradeId: gradeId,
                    name:userName
                }*/
            });

            //头工具栏事件
            table.on('toolbar(test)', function(obj){
                var checkStatus = table.checkStatus(obj.config.id);
                switch(obj.event) {
                    // 修改功能，对应上个script中的lay-event
                    case 'getCheckData':
                        var data = checkStatus.data;
                        var one = table.checkStatus("demo");
                        var two = one.data;
                        if (two.length == 0) {
                            layer.msg("请先选择一位用户！");
                            return false;
                        }else if(two.length>1){
                            layer.msg("修改只能选择一个用户！");
                            return false
                        }
                        var userId;
                        var userName;
                        var userSex;
                        var userBirthday;
                        var userWorkhours;
                        var userJoinparty;
                        var userIdentity;
                        var userAddress;
                        var userEmail;
                        var userPhone;
                        var titleName;
                        var titleTime;
                        var positionName;
                        var qualificationName;
                        var subjectName;
                        var contractName;
                        var contractStarttime;
                        var contractEndtime;
                        var educationFirstName;
                        var educationFirstSchool;
                        var educationFirstProfessionalName;
                        var educationFirstGraduationtime;
                        var degreeName;
                        var educationHighestName;
                        var educationHighestSchool;
                        var educationHighestProfessionalName;
                        var educationHighestGraduationtime;
                        var remarks;
                        var isAdmin;
                        for (var i = 0; i < two.length; i++) {
                            userId = two[i].userId;
                            userName = two[i].userName;
                            userSex = two[i].userSex;
                            userBirthday = two[i].userBirthday;
                            userWorkhours = two[i].userWorkhours;
                            userJoinparty = two[i].userJoinparty;
                            userIdentity = two[i].userIdentity;
                            userAddress = two[i].userAddress;
                            userEmail = two[i].userEmail;
                            userPhone = two[i].userPhone;
                            titleName = two[i].title.titleName;
                            titleTime = two[i].titleTime;
                            positionName = two[i].position.positionName;
                            qualificationName = two[i].qualification.qualificationName;
                            subjectName = two[i].subject.subjectName;
                            contractName = two[i].contract.contractName;
                            contractStarttime = two[i].contractStarttime;
                            contractEndtime = two[i].contractEndtime;
                            educationFirstName = two[i].educationFirstName;
                            educationFirstSchool = two[i].educationFirstSchool;
                            educationFirstProfessionalName = two[i].educationFirstProfessionalName;
                            educationFirstGraduationtime = two[i].educationFirstGraduationtime;
                            degreeName = two[i].degree.degreeName;
                            educationHighestName = two[i].educationHighestName;
                            educationHighestSchool = two[i].educationHighestSchool;
                            educationHighestProfessionalName = two[i].educationHighestProfessionalName;
                            educationHighestGraduationtime = two[i].educationHighestGraduationtime;
                            remarks = two[i].remarks;
                            isAdmin = two[i].isAdmin;
                        }

                        var open = layer.open({
                            type: 1,
                            // time: 20000,
                            skin: 'layui-layer-rim', //加上边框
                            area: ['600px', '500px'], //宽高

                            content: '<form class="layui-form form" style="margin-left: 100px" id="form">  <div class="layui-form-item">\n' +
                                '    <div class="layui-input-inline" style="margin-left: 130px"><label class="layui-form-label">用户信息</label></div>\n' +
                                //    个人编号
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">个人编号</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userId" id="userId" value="' + userId + '" required  lay-verify="required" placeholder="请输入标题" autocomplete="off" class="layui-input" disabled>\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      姓名
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">姓名</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userName" id="userName" value="' + userName + '" required  lay-verify="required" placeholder="请输入姓名" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      身份证
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">身份证</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userIdentity" id="userIdentity" value="' + userIdentity + '" required  lay-verify="required" placeholder="请输入身份证" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      电话
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">电话</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userPhone" id="userPhone" value="' + userPhone + '" required  lay-verify="required" placeholder="请输入电话" autocomplete="off" class="layui-input" disabled>\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      地址
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">地址</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userAddress" id="userAddress" value="' + userAddress + '" required  lay-verify="required" placeholder="请输入地址" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      性别
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">性别</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="userSex" id="userSex" value="' + userSex + '" required  lay-verify="required" placeholder="请输入性别" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      出生日期
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">出生日期</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="userBirthday" id="userBirthday" value="' + userBirthday + '" required  lay-verify="date" placeholder="请输入生日" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      入党时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">入党时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="userJoinparty" id="userJoinparty" value="' + userJoinparty + '" required  lay-verify="date" placeholder="请输入入党时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      入职时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">入职时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="userWorkhours" id="userWorkhours" value="' + userWorkhours + '" required  lay-verify="date" placeholder="请输入工作时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      职称资格证
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">职称资格证</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="titleId" id="titleId" value="' + titleName + '" required  lay-verify="required" placeholder="请输入职称资格证" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      教师资格种类
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">教师资格种类</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="qualificationId" id="qualificationId" value="' + qualificationName + '" required  lay-verify="required" placeholder="请输入教师资格种类" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      请输入职称资格时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">职称资格时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="titleTime" id="titleTime" value="' + titleTime + '" required  lay-verify="date" placeholder="请输入职称资格时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      专业技术职务
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">专业技术职务</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="positionId" id="positionId" value="' + positionName + '" required  lay-verify="required" placeholder="请输入专业技术职务" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      合同编号
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">合同编号</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="contractId" id="contractId" value="' + contractName + '" required  lay-verify="required" placeholder="合同编号" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      请输入首聘时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">首聘时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="contractStarttime" id="contractStarttime" value="' + contractStarttime + '" required  lay-verify="date" placeholder="请输入首聘时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      请输入聘任时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">聘任时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="contractEndtime" id="contractEndtime" value="' + contractEndtime + '" required  lay-verify="date" placeholder="请输入聘任时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      第一学历
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">第一学历</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationFirstName" id="educationFirstName" value="' + educationFirstName + '" required  lay-verify="required" placeholder="请输入第一学历" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      第一学历毕业院校
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">第一学历毕业院校</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationFirstSchool" id="educationFirstSchool" value="' + educationFirstSchool + '" required  lay-verify="required" placeholder="请输入第一学历毕业院校" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      第一学历所学专业
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">第一学历所学专业</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationFirstProfessionalName" id="educationFirstProfessionalName" value="' + educationFirstProfessionalName + '" required  lay-verify="required" placeholder="请输入第一学历所学专业" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      第一学历毕业时间
                                '  <div class="layui-form-ite   m" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">第一学历毕业时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="educationFirstGraduationtime" id="educationFirstGraduationtime" value="' + educationFirstGraduationtime + '" required  lay-verify="date" placeholder="请输入第一学历毕业时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      学位
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">学位</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="degreeId" id="degreeId" value="' + degreeName + '" required  lay-verify="required" placeholder="请输入学位" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      最高学历
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">最高学历</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationHighestName" id="educationHighestName" value="' + educationHighestName + '" required  lay-verify="required" placeholder="请输入最高学历" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      最高学历毕业院校
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">最高学历毕业院校</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationHighestSchool" id="educationHighestSchool" value="' + educationHighestSchool + '" required  lay-verify="required" placeholder="请输入最高学历毕业院校" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      最高学历所学专业
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">最高学历所学专业</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="educationHighestProfessionalName" id="educationHighestProfessionalName" value="' + educationHighestProfessionalName + '" required  lay-verify="required" placeholder="请输入最高学历所学专业" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      最高学历毕业时间
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">最高学历毕业时间</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="date" name="educationHighestGraduationtime" id="educationHighestGraduationtime" value="' + educationHighestGraduationtime + '" required  lay-verify="date" placeholder="请输入最高学历毕业时间" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      备注
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">备注</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="remarks" id="remarks" value="' + remarks + '" required  lay-verify="required" placeholder="请输入备注" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      身份
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">身份</label>\n' +
                                '    <div class="layui-input-block">\n' +
                                '      <input type="text" name="isAdmin" id="isAdmin" value="' + isAdmin + '" required  lay-verify="required" placeholder="请输入身份" autocomplete="off" class="layui-input">\n' +
                                '    </div>\n' +
                                '  </div>' +
                                //      学科编号
                                '  <div class="layui-form-item" style="margin-right: 150px">\n' +
                                '    <label class="layui-form-label">任教学科</label>\n' +
                                '    <div class="layui-input-block" style="display: block">\n' +
                                '      <input type="text" name="subjectId" id="subjectId" value="' + subjectName + '" required  lay-verify="required" placeholder="请输入学科名称" autocomplete="off" class="layui-input">\n' +
                                '<input type="text" style="display: none" id="isUpdate">' +
                                '    </div>\n' +
                                ' <div class="layui-input-inline" style="margin-left: 120px"><input type="button" value="修改" class="layui-btn layui-btn-primary" style="margin: 50px" id="submit"></div> </div>' +
                                '</form>'
                        });
                        //学科名失去焦点
                        $("#subjectId").blur(function () {
                            var subjectName = $(this).val();
                            isHaveSubjectName(subjectName);
                        });

                        //判断学科名存在 函数
                        function isHaveSubjectName(subjectName) {
                        $.getJSON("/subject/isHaveSubjectName", "subjectName=" + subjectName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //学科名存在
                                    // return true;
                                } else {
                                    alert("学科名不存在！");
                                    $("#subjectId").val("");
                                    // return false;
                                }
                            }
                        });
                    }

                        //职称资格名失去焦点
                        $("#titleId").blur(function () {
                            var titleName = $(this).val();
                            isHaveTitleName(titleName);
                        });

                        //判断学科名存在 函数
                    function isHaveTitleName(titleName) {
                        $.getJSON("/title/isHaveTitleName", "titleName=" + titleName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //职称资格名存在
                                    // return true;
                                } else {
                                    alert("职称资格名不存在！");
                                    $("#titleId").val("");
                                    // return false;
                                }
                            }
                        });
                    }

                        //专业技术职务名失去焦点
                        $("#positionId").blur(function () {
                            var positionName = $(this).val();
                            isHavePositionName(positionName);
                        });

                        //判断学科名存在 函数
                    function isHavePositionName(positionName) {
                        $.getJSON("/position/isHavePositionName", "positionName=" + positionName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //专业技术职务名存在
                                    // return true;
                                } else {
                                    alert("专业技术职务名不存在！");
                                    $("#positionId").val("");
                                    // return false;
                                }
                            }
                        });
                    }

                        //教师资格种类名失去焦点
                        $("#qualificationId").blur(function () {
                            var qualificationName = $(this).val();
                            isHaveQualificationName(qualificationName);
                        });

                        //判断教师资格种类名存在 函数
                    function isHaveQualificationName(qualificationName) {
                        $.getJSON("/qualification/isHaveQualificationName", "qualificationName=" + qualificationName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //教师资格种类名存在
                                    // return true;
                                } else {
                                    alert("教师资格种类名不存在！");
                                    $("#qualificationId").val("");
                                    // return false;
                                }
                            }
                        });
                    }

                        //合同名失去焦点
                        $("#contractId").blur(function () {
                            var contractName = $(this).val();
                            isHaveContractName(contractName);
                        });

                        //判断合同名存在 函数
                    function isHaveContractName(contractName) {
                        $.getJSON("/contract/isHaveContractName", "contractName=" + contractName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //合同名存在
                                    // return true;
                                } else {
                                    alert("合同名不存在！");
                                    $("#contractId").val("");
                                    // return false;
                                }
                            }
                        });
                    }
                        //学位名失去焦点
                        $("#degreeId").blur(function () {
                            var degreeName = $(this).val();
                            isHaveDegreeName(degreeName);
                        });

                        //判断学位存在 函数
                    function isHaveDegreeName(contractName) {
                        $.getJSON("/degree/isHaveDegreeName", "degreeName=" + degreeName, function (data) {
                            if (data != null) {
                                if (data.toString() == "true") {   //学位存在
                                    // return true;
                                } else {
                                    alert("学位不存在！");
                                    $("#degreeId").val("");
                                    // return false;
                                }
                            }
                        });
                    }

                        //新增点击事件
                        $("#submit").click(function () {
                            var userId = $("#userId").val();
                            var userName = $("#userName").val();
                            var userSex = $("#userSex").val();
                            if (userSex == "男") {
                                userSex = 0;
                            } else if (userSex == "女") {
                                userSex = 1;
                            } else {
                                layer.msg("性别错误");
                                return false;
                            }
                            var userBirthday = $("#userBirthday").val();
                            var userWorkhours = $("#userWorkhours").val();
                            var userJoinparty = $("#userJoinparty").val();
                            var userIdentity = $("#userIdentity").val();
                            var userAddress = $("#userAddress").val();
                            var userEmail = $("#userEmail").val();
                            var userPhone = $("#userPhone").val();
                            var titleName = $("#titleId").val();
                            var titleTime = $("#titleTime").val();
                            var positionName = $("#positionId").val();
                            var qualificationName = $("#qualificationId").val();
                            var subjectName = $("#subjectId").val();
                            var contractName = $("#contractId").val();
                            var contractStarttime = $("#contractStarttime").val();
                            var contractEndtime = $("#contractEndtime").val();
                            var educationFirstName = $("#educationFirstName").val();
                            var educationFirstSchool = $("#educationFirstSchool").val();
                            var educationFirstProfessionalName = $("#educationFirstProfessionalName").val();
                            var educationFirstGraduationtime = $("#educationFirstGraduationtime").val();
                            var degreeName = $("#degreeId").val();
                            var educationHighestName = $("#educationHighestName").val();
                            var educationHighestSchool = $("#educationHighestSchool").val();
                            var educationHighestProfessionalName = $("#educationHighestProfessionalName").val();
                            var educationHighestGraduationtime = $("#educationHighestGraduationtime").val();
                            var remarks = $("#remarks").val();
                            var isAdmin = $("#isAdmin").val();
                            if (isAdmin == "普通员工") {
                                isAdmin = 0;
                            } else if (isAdmin == "管理员") {
                                isAdmin = 1;
                            } else {
                                layer.msg("身份输入错误");
                                return false;
                            }
                            var subjectId=0;
                            var titleId=0;
                            var positionId=0;
                            var qualificationId=0;
                            var contractId=0;
                            var degreeId=0;
                            //判断班级名是否存在
                            $.ajax({
                                type: "POST",
                                url: "/subject/isHaveSubjectName2",
                                data: "subjectName=" + subjectName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //学科名不存在
                                            $("#subjectId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            subjectId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            //判断职称资格证名是否存在
                            $.ajax({
                                type: "POST",
                                url: "/title/isHaveTitleName2",
                                data: "titleName=" + titleName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //职称资格证名不存在
                                            $("#titleId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            titleId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            //判断专业技术职务名是否存在
                            $.ajax({
                                type: "POST",
                                url: "/position/isHavePositionName2",
                                data: "positionName=" + positionName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //专业技术职务名不存在
                                            $("#positionId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            positionId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            //判断教师资格种类名是否存在
                            $.ajax({
                                type: "POST",
                                url: "/qualification/isHaveQualificationName2",
                                data: "qualificationName=" + qualificationName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //教师资格种类名不存在
                                            $("#qualificationId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            qualificationId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            //判断合同名是否存在
                            $.ajax({
                                type: "POST",
                                url: "/contract/isHaveContractName2",
                                data: "contractName=" + contractName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //合同名不存在
                                            $("#contractId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            contractId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            //判断学位是否存在
                            $.ajax({
                                type: "POST",
                                url: "/degree/isHaveDegreeName2",
                                data: "degreeName=" + degreeName,
                                //防止自动转换数据格式。
                                dataType: "json",
                                async: false,
                                success: function (data) {
                                    if (data != null) {
                                        if (data.toString() == "false") {   //学位不存在
                                            $("#degreeId").val("");
                                            $("#isUpdate").val("0");
                                        } else {
                                            degreeId = data.toString();
                                            $("#isUpdate").val("1");
                                        }
                                    }
                                }
                            });
                            if (userPhone == "" || userPhone == null || userPhone.length != 11) {
                                layer.msg("手机号格式错误！！");
                                return false;
                            } else if (userName == "" || userName == null) {
                                layer.msg("姓名不能为空！");
                                return false;
                            } else if (userBirthday == "" || userBirthday == null) {
                                layer.msg("出生日期不能为空！");
                                return false;
                            } else if (userIdentity == "" || userIdentity == null) {
                                layer.msg("身份证号不能为空！");
                                return false;
                            } else if (subjectName == "" || subjectName == null) {
                                layer.msg("任教学科名不能为空！");
                                return false;
                            } else if (userIdentity.length < 18 || userIdentity.length > 18) {
                                layer.msg("身份证号格式不正确！");
                                return false;
                            } else if ($("#isUpdate").val() == "0") {
                                return false;
                            } else {
                                // alert("触发修改");
                                layer.close(open);
                                $.getJSON("/teacher/updateTeacher",
                                    "userName=" + userName + "&userIdentity=" + userIdentity + "&userAddress=" + userAddress
                                    + "&userId=" + userId + "&userSex=" + userSex + "&userBirthday=" + userBirthday +"&userWorkhours=" + userWorkhours
                                    + "&userJoinparty="+userJoinparty + "&userPhone=" + userPhone + "&userEmail=" + userEmail + "&titleId=" + titleId
                                    + "&titleTime=" + titleTime + "&positionId=" + positionId + "&qualificationId=" + qualificationId
                                    + "&subjectId=" + subjectId + "&contractId=" + contractId + "&contractStarttime=" + contractStarttime
                                    + "&contractEndtime=" + contractEndtime + "&educationFirstName=" + educationFirstName + "&educationFirstSchool=" + educationFirstSchool
                                    + "&educationFirstProfessionalName=" + educationFirstProfessionalName + "&educationFirstGraduationtime=" + educationFirstGraduationtime
                                    + "&degreeId=" + degreeId + "&educationHighestName=" + educationHighestName + "&educationHighestSchool=" + educationHighestSchool
                                    + "&educationHighestProfessionalName=" + educationHighestProfessionalName + "&educationHighestGraduationtime=" + educationHighestGraduationtime
                                    + "&remarks=" + remarks + "&isAdmin=" + isAdmin, function (data) {
                                    if (data != null) {
                                        if (data.toString() == "true") {
                                            layer.alert("修改成功！！");
                                            var subjectId=0;
                                            var titleId=0;
                                            var positionId=0;
                                            var qualificationId=0;
                                            var contractId=0;
                                            var degreeId=0;
                                            layer.close(open);
                                            //刷新页面
                                            $("#content").load("/intoTeacherInfo", function () {
                                                layui.use('element', function () {
                                                    var element = layui.element;
                                                });
                                            });

                                        } else {
                                            layer.alert("修改失败！！");
                                        }

                                    }
                                })
                            }
                        });


                        break;
                    case
                    'getCheckLength'
                    :
                        var data = checkStatus.data;
                        var list = new Array();
                        for (var i = 0; i < data.length; i++) {
                            list[i] = data[i].userId
                        }
                        if (list.length == 0) {
                            layer.msg("请先选择一位用户！");
                            return false;
                        } else {
                            var userId;
                            layer.confirm('真的要删除吗？', function (index) {
                                $.getJSON("/teacher/delTeacher?list=" + list, function (data) {
                                    if (data.toString() == "true") {
                                        layer.msg("删除成功！！");
                                        $("#content").load("/intoTeacherInfo", function (data) {
                                            if (eval('(' + data + ')').Code.toString() == "600") {
                                                window.location = "/user/toErrorLogin";
                                                return;
                                            }
                                            layui.use('element', function () {
                                                var element = layui.element;
                                            });
                                        });
                                    }
                                });
                            });
                        }
                        ;
                };
            });

        });
    }

</script>
</body>
</html>